﻿<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script type="text/javascript" src="http://jsx.vanclimg.com/jquery/jquery-1.7.1.min.js"></script>
    <script>
        jQuery.fn.slidePicture = function (params) {
            var defaults = {
                container: 'slider',
                frameContainer: 'pictureList',
                numContainer: 'num'
            };

            var frames = $('li', $('#' + defaults.frameContainer));
            var numContainer = $('#' + defaults.numContainer);
            var frameCount = frames.size();
            var numbers;

            var init = function () {
                for (var i = 1; i <= frameCount; i++) {
                    if (i == 1) { numContainer.append('<li class="curr">' + i + '</li>'); }
                    else { numContainer.append('<li>' + i + '</li>'); }
                }
                numbers = $('li', numContainer);

                numbers.mouseenter(function () {
                    var index = $(this).index();
                    if (current == index) { return; }
                    stopPlay();

                    hideFrame(current);
                    current = index;
                    showFrame(current);
                }).mouseout(function () {
                    startPlay();
                });
            }

            var current = 0;
            var timer;
            var startPlay = function () {
                window.clearInterval(timer);
                timer = window.setInterval(function () {
                    hideFrame(current);
                    current++;
                    if (current >= frameCount) {
                        current = 0;
                    }

                    showFrame(current);
                }, 3000);
            }

            var showFrame = function (index) {
                $(numbers[current]).addClass('curr');
                $(frames[current]).fadeIn();
            }

            var hideFrame = function (index) {
                $(numbers[index]).removeClass('curr');
                $(frames[index]).fadeOut();
            }
            var stopPlay = function () {
                window.clearInterval(timer);
            }
            init();
            startPlay();
        }

        jQuery.fn.imageScroller = function (params) {
            var defaults = {
                next: "#buttonNext",   //左按钮,传入一个selector
                prev: "#buttonPrev",   //右按钮,传入一个selector
                frame: "#frameView",   //滚动图片的父容器,传入一个selector
                width: 154,            //单个child滚动宽度(需包含边框)
                child: "li",           //滚动元素
                auto: true,            //是否自动滚动
                nAutoInterval: 3000,    //自滚动间隔时间
                nScrollChildren: 1,     //一次滚动child数
                nVisibleChildren: 6,    //每屏显示数		
                sScrollSpeed: 'slow',   //滚动速度 slow normal fast,可直接设置毫秒数
                bHoverStop: true,       //鼠标悬停在元素上是否停止滚动
                sMouseCursor: 'pointer', //按钮鼠标显示样式 
                sScrollDirection: 'marginLeft', //左右滚动时为'marginLeft',上下滚动式传入参数'marginTop'
                fCallBack: function () { } //滚动效果初始化后回调函数
            };
            var p = $.extend(defaults, params);
            var _btnNext = $(p.next);
            var _btnPrev = $(p.prev);
            var _imgFrame = $(p.frame);
            var _auto = p.auto;
            var _interval;  //interval事件	
            var _oScrollDirection1, _oScrollDirection2;      //兼容左右滚动和上下滚动
            var _oChildren = _imgFrame.find(p.child), _cLen = _oChildren.size();
            var _playing = false;

            var init = function () {
                //如果容器内容不足，取消初始化
                if (_cLen < p.nVisibleChildren) {
                    return;
                }

                _imgFrame.prepend(_oChildren.slice(_cLen - p.nVisibleChildren).clone(true)).append(_oChildren.slice(0, p.nVisibleChildren).clone(true));
                _cLen = _imgFrame.find(p.child).size();
                p.curr = p.start = p.nVisibleChildren;
                _imgFrame.css(p.sScrollDirection, -(p.curr * p.width));
                //console.log(_cLen);
                if (p.sScrollDirection == "marginLeft") {
                    _imgFrame.width(_cLen * p.width);     //重置滚动容器宽度
                    _oScrollDirection1 = { marginLeft: "-=" + p.nScrollChildren * p.width };
                    _oScrollDirection2 = { marginLeft: "+=" + p.nScrollChildren * p.width };
                }
                else {
                    _imgFrame.height(_cLen * p.width);     //重置滚动容器高度
                    _oScrollDirection1 = { marginTop: "-=" + p.nScrollChildren * p.width };
                    _oScrollDirection2 = { marginTop: "+=" + p.nScrollChildren * p.width };
                }

                //按钮事件样式绑定
                if (p.sMouseCursor != "") {
                    _btnNext.css("cursor", p.sMouseCursor);
                    _btnPrev.css("cursor", p.sMouseCursor);
                }
                _btnNext.click(turnRight);
                _btnPrev.click(turnLeft);

                //鼠标hover停止函数
                if (p.bHoverStop && _auto) {
                    _imgFrame.hover(
			  function () { fAutoStop(); },
			  function () { fAutoPlay(); }
			);
                };
                //回调函数
                p.fCallBack.call(_imgFrame);

                //自动滚动函数
                if (_auto) {
                    fAutoPlay();
                };
            };
            //向左(或向上)滚动	   
            var turnLeft = function () {
                if (_playing) return;
                _playing = true;
                if (_auto) fAutoStop();
                if (p.curr - p.nScrollChildren <= p.start - p.nVisibleChildren - 1) {
                    p.curr = _cLen - p.nVisibleChildren * 2 + p.curr;
                    _imgFrame.css(p.sScrollDirection, -(p.curr * p.width) + "px");
                }
                p.curr -= p.nScrollChildren;

                _imgFrame.animate(p.sScrollDirection == "marginLeft" ? { marginLeft: -(p.curr * p.width)} : { marginTop: -(p.curr * p.width) }, p.sScrollSpeed, '', function () {
                    _playing = false;
                    if (_auto) fAutoPlay();
                });
            };

            //向右(或向下)滚动
            var turnRight = function () {
                if (_playing) return;
                _playing = true;
                if (_auto) fAutoStop();
                if (p.curr + p.nScrollChildren >= _cLen - p.nVisibleChildren + 1) {
                    p.curr = p.curr - _cLen + p.nVisibleChildren * 2;
                    _imgFrame.css(p.sScrollDirection, -(p.curr * p.width) + "px");
                }
                p.curr += p.nScrollChildren;
                _imgFrame.animate(p.sScrollDirection == "marginLeft" ? { marginLeft: -(p.curr * p.width)} : { marginTop: -(p.curr * p.width) }, p.sScrollSpeed, '', function () {
                    _playing = false;
                    if (_auto) fAutoPlay();
                });
            };

            //自动滚动
            var fAutoPlay = function () {
                _interval = window.setTimeout(turnRight, p.nAutoInterval);
            };

            //停止自动滚动
            var fAutoStop = function () {
                window.clearTimeout(_interval);
            };

            //获取元素偏移顶部距离
            var offsettop = function (element) {
                var actualtop = element.offsetTop;
                var current = element.offsetParent;
                while (current !== null) {
                    actualtop += current.offsetTop;
                    current = current.offsetParent;
                }

                return actualtop;
            };

            //获取浏览器当前可视区域大小
            var clientHeight = function () {
                var pageHeight;
                if (typeof pageHeight != "number") {
                    if (document.compatMode == "CSS1Compat") {
                        pageHeight = document.documentElement.clientHeight;
                    } else {
                        pageHeight = document.body.clientHeight;
                    }
                }

                return pageHeight;
            };

            var offsetTop = offsettop(_imgFrame[0]);
            var scroll = function () {
                var scrollTop = document.body.scrollTop | document.documentElement.scrollTop;
                //如果是滚动到滚动图当前屏
                if (offsetTop <= (clientHeight() + scrollTop)) {
                    init();
                    $(window).off("scroll", scroll);
                }
            };
            //如果是当前屏是滚动图所在屏
            if (offsetTop <= (clientHeight() + (document.body.scrollTop | document.documentElement.scrollTop))) {
                init();
            } else {
                $(window).on("scroll", scroll);
            }
        };

        $(function () {
            $("#slider").slidePicture();
            $("#company").imageScroller();
        });
    </script>

    <style>
        #slider{ position:relative;width:490px; height:170px; overflow:hidden; }
        #slider ul { list-style:none;  }
        #slider #num{ position:absolute; bottom:5px; right:5px;}
        #slider ul#num li{ height:16px; width:16px; cursor:pointer; float:left; color:#F60; background:#fff; text-align:center; line-height:16px; border:1px solid #D8D8D8; margin-right:2px; opacity:0.7; filter:alpha(opacity=70);}
        .curr{background-color:#F60 !important; color:#fff !important; font-weight:bold; opacity:1 !important;filater:alpha(opacity=1) !important;}
	
	#links{width:960px; height:126px;overflow:hidden;}
#links ul{list-style:none; }
#links ul li{float:left; margin:0 8px 0 3px;}
#links ul li img{width:141px; height:67px;}

#imagesContainer {float:left;width:900px;overflow:hidden;}
        #buttonNext{float:left; width:21px; height:100px;}
        #buttonPrev{float:left;width:20px;width:21px; height:100px;} 
    </style>
</head>
<body>
    <div id="slider">
        <ul id="pictureList">
          <li><img src="http://img03.taobaocdn.com/tps/i3/T1prVTXpVcXXa6XtY7-490-170.png"></li>
            <li><img border="0" src="http://i.mmcdn.cn/simba/img/T1f.8UXrXXXXb1upjX.jpg" width="490px" height="170px"></li>
            <li><img src="http://img01.taobaocdn.com/tps/i1/T1H4BTXzBcXXa6XtY7-490-170.png"></li>
        </ul>
        <ul id="num"></ul>
    </div>
 
<div style="clear:both"></div>
    <div id="links">
        <div id="buttonPrev">左</div>
        <div id="imagesContainer">
            <ul id="frameView">
             <li><a href="http://item.vancl.com/0191706.html"><img alt="" src="http://i2.vanclimg.com/www/company/13.png"></a></li><li><a href="http://item.vancl.com/0191630.html"><img alt="" src="http://i3.vanclimg.com/www/company/14.png"></a></li><li><a href="http://item.vancl.com/0192069.html"><img alt="" src="http://i5.vanclimg.com/www/company/11.png"></a></li><li><a href="http://item.vancl.com/0192408.html"><img alt="" src="http://i1.vanclimg.com/www/company/12.png "></a></li><li><a href="http://item.vancl.com/0192606.html"><img alt="" src="http://i4.vanclimg.com/www/company/15.png"></a></li><li><a href="http://home.vancl.com/27541-n10-s1.html"><img alt="" src="http://i5.vanclimg.com/www/company/16.png"></a></li><li><a href="http://miook.vancl.com/27535-s1.html"><img alt="" src="http://i1.vanclimg.com/www/company/17.png"></a></li>
            </ul> 
         </div>
        <div id="buttonNext">右</div>
    </div>
</body>
</html>

		